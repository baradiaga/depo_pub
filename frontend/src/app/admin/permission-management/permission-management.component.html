<div class="container">
  <h2>Gestion des Permissions jjjj</h2>

  <table class="table">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Email</th>
        <th>Rôle</th>
        <th>Permissions</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of utilisateurs">
        <td>{{ user.nom }} {{ user.prenom }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.role }}</td>
        <td>{{ getPermissionCount(user) }}</td>
        <td>
          <button (click)="openPermissionModal(user)">Modifier</button>
          <button (click)="resetToDefaultPermissions(user)">Réinitialiser</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Modal Permissions -->
  <div *ngIf="showPermissionModal" class="modal">
    <div class="modal-content">
      <h3>Modifier les permissions de {{ selectedUser?.nom }} {{ selectedUser?.prenom }}</h3>

      <div class="actions">
        <button (click)="selectAllPermissions()">Tout sélectionner</button>
        <button (click)="deselectAllPermissions()">Tout désélectionner</button>
        <button (click)="selectRoleDefaults()">Par défaut du rôle</button>
      </div>

      <ul class="permissions-list">
        <li *ngFor="let permission of availablePermissions">
          <label>
            <input type="checkbox"
                   [checked]="isPermissionSelected(permission.id)"
                   (change)="togglePermission(permission.id)" />
            {{ permission.nom }}
          </label>
        </li>
      </ul>

      <div class="modal-footer">
        <button (click)="savePermissions()">Enregistrer</button>
        <button (click)="closePermissionModal()">Annuler</button>
      </div>
    </div>
  </div>

  
</div>
