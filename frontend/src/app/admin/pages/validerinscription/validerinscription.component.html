<!-- Fichier: src/app/features/admin/components/valider-inscription/valider-inscription.component.html -->

<div class="container mt-5">
  <div class="row">
    <div class="col-md-12">
      <h2 class="mb-4">Gestion des Validations d'Inscription</h2>

      <!-- Message d'erreur -->
      <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>Erreur :</strong> {{ error }}
        <button type="button" class="btn-close" (click)="fermerErreur()"></button>
      </div>

      <!-- Message de succès -->
      <div *ngIf="success" class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>Succès :</strong> {{ success }}
        <button type="button" class="btn-close" (click)="fermerSucces()"></button>
      </div>

      <!-- Indicateur de chargement -->
      <div *ngIf="loading" class="text-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Chargement...</span>
        </div>
        <p class="mt-2">Chargement des inscriptions en attente...</p>
      </div>

      <!-- Tableau des inscriptions en attente -->
      <div *ngIf="!loading && inscriptions.length > 0" class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>#</th>
              <th>Étudiant</th>
              <th>Email</th>
              <th>Matière</th>
              <th>Code</th>
              <th>Date d'Inscription</th>
              <th>Statut</th>
              <th>Actif</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let inscription of inscriptions">
              <td>{{ inscription.id }}</td>
              
              <!-- Étudiant -->
              <td>{{ inscription.etudiantNomComplet || 'N/A' }}</td>
              <td>{{ inscription.etudiantEmail || 'N/A' }}</td>

              <!-- Matière -->
              <td>{{ inscription.ecNom || 'N/A' }}</td>
              <td>{{ inscription.ecCode || 'N/A' }}</td>

              <!-- Date -->
              <td>{{ inscription.dateInscription | date: 'dd/MM/yyyy HH:mm' }}</td>

              <!-- Statut -->
              <td>
                <span class="badge bg-warning text-dark">{{ inscription.statut }}</span>
              </td>

              <!-- Actif -->
              <td>
                <span *ngIf="inscription.actif" class="badge bg-success">Actif</span>
                <span *ngIf="!inscription.actif" class="badge bg-secondary">Inactif</span>
              </td>

              <!-- Actions -->
              <td>
                <div class="btn-group btn-group-sm" role="group">
                  <button 
                    class="btn btn-success" 
                    (click)="validerInscription(inscription)"
                    title="Valider cette inscription">
                    <i class="bi bi-check-circle"></i> Valider
                  </button>
                  <button 
                    class="btn btn-danger" 
                    (click)="rejeterInscription(inscription)"
                    title="Rejeter cette inscription">
                    <i class="bi bi-x-circle"></i> Rejeter
                  </button>
                  <button 
                    *ngIf="inscription.actif"
                    class="btn btn-warning" 
                    (click)="desactiverInscription(inscription)"
                    title="Désactiver cette inscription">
                    <i class="bi bi-toggle-on"></i> Désactiver
                  </button>
                  <button 
                    *ngIf="!inscription.actif"
                    class="btn btn-info" 
                    (click)="activerInscription(inscription)"
                    title="Activer cette inscription">
                    <i class="bi bi-toggle-off"></i> Activer
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Message si aucune inscription en attente -->
      <div *ngIf="!loading && inscriptions.length === 0" class="alert alert-info">
        <strong>Information :</strong> Aucune inscription en attente de validation.
      </div>

      <!-- Bouton de rafraîchissement -->
      <div class="mt-4">
        <button 
          class="btn btn-primary" 
          (click)="chargerInscriptionsEnAttente()"
          [disabled]="loading">
          <i class="bi bi-arrow-clockwise"></i> Rafraîchir
        </button>
      </div>

    </div>
  </div>
</div>
