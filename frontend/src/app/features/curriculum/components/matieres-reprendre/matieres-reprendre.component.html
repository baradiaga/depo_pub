<!-- Fichier : src/app/pages/matieres-reprendre/matieres-reprendre.component.html -->

<div class="container mt-4">
  <!-- En-tête de la page -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Mon Curriculum</h2>
    <div class="col-5">
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-search"></i></span>
        <!-- La barre de recherche qui appelle la méthode filterMatieres() -->
        <input 
          type="text" 
          class="form-control" 
          placeholder="Rechercher une matière par nom ou code..."
          [(ngModel)]="searchTerm"
          (ngModelChange)="filterMatieres()">
      </div>
    </div>
  </div>

  <!-- Indicateur de chargement -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status"></div>
    <p class="mt-3">Chargement de vos matières...</p>
  </div>

  <!-- Conteneur pour les cartes de matières -->
  <div *ngIf="!isLoading">
    <div class="row">
      <!-- On boucle sur la liste des matières filtrées -->
      <div *ngFor="let matiere of filteredMatieres" class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 shadow-sm">
          <div class="card-body d-flex flex-column">
            <!-- Nom de la matière et code -->
            <h5 class="card-title">{{ matiere.nom }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ matiere.code }}</h6>
            
            <!-- Description de la matière -->
            <p class="card-text flex-grow-1">{{ matiere.description || 'Aucune description disponible.' }}</p>
            
            <hr>

            <!-- Informations supplémentaires -->
            <div class="d-flex justify-content-between text-muted small mb-3">
              <span>Crédits : <strong>{{ matiere.credit }}</strong></span>
              <span *ngIf="matiere.enseignant">
                Ens. : <strong>{{ matiere.enseignant.prenom }} {{ matiere.enseignant.nom }}</strong>
              </span>
            </div>

            <!-- ========================================================== -->
            <!-- === LE LIEN IMPORTANT EST ICI                            === -->
            <!-- ========================================================== -->
            <!-- Ce lien navigue vers la page de détail du syllabus -->
            <a [routerLink]="['/app/curriculum/matieres', matiere.id]" class="btn btn-primary mt-auto">
              Voir le syllabus <i class="fas fa-arrow-right ms-1"></i>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Message si aucune matière n'est trouvée -->
    <div *ngIf="filteredMatieres.length === 0 && !isLoading" class="text-center py-5">
      <p class="text-muted">
        {{ matieres.length === 0 ? 'Vous n\'êtes inscrit à aucune matière pour le moment.' : 'Aucune matière ne correspond à votre recherche.' }}
      </p>
    </div>
  </div>
</div>
