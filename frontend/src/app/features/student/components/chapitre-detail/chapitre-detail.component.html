<!-- Fichier : src/app/features/student/pages/chapitre-detail/chapitre-detail.component.html (Version finale) -->

<!-- On utilise le pipe 'async' pour gérer l'Observable et l'état de chargement automatiquement -->
<ng-container *ngIf="chapitre$ | async as chapitre; else loadingOrError">
  
  <div class="chapitre-container">
    
    <!-- En-tête du chapitre -->
    <header class="chapitre-header">
      <h1>{{ chapitre.nom }}</h1>
      <p class="objectif">{{ chapitre.objectif }}</p>
    </header>

    <!-- Contenu des sections -->
    <main class="sections-container">
      <div *ngFor="let section of chapitre.sections" class="section-card">
        <h2>{{ section.titre }}</h2>
        <!-- 
          [innerHTML] est utilisé pour interpréter le contenu HTML qui vient de la base de données.
          Angular le nettoie pour éviter les failles de sécurité (XSS).
        -->
        <div class="section-content" [innerHTML]="section.contenu"></div>
      </div>
    </main>

    <!-- Pied de page avec le bouton d'action -->
    <footer class="chapitre-footer">
      <button class="btn btn-primary btn-lg" (click)="passerLeTest()">
        Passer le Test
      </button>
    </footer>

  </div>

</ng-container>

<!-- Template affiché pendant le chargement ou en cas d'erreur -->
<ng-template #loadingOrError>
  <div class="loading-spinner">
    <p>Chargement du chapitre...</p>
    <!-- Vous pouvez ajouter un vrai spinner ici si vous le souhaitez -->
  </div>
</ng-template>
